Index: evutil.h
===================================================================
--- evutil.h    (revision 709)
+++ evutil.h    (working copy)
@@ -54,9 +54,13 @@
 #ifdef _EVENT_HAVE_UINT64_T
 #define ev_uint64_t uint64_t
 #define ev_int64_t int64_t
-#elif defined(WIN32)
+#elif defined(WIN32)
 #define ev_uint64_t __uint64_t
-#define ev_int64_t __int64_t
+#if ( _MSC_VER < 1300 )
+#define ev_int64_t __int64
+#else
+#define ev_int64_t __int64_t
+#endif
 #elif _EVENT_SIZEOF_LONG_LONG == 8
 #define ev_uint64_t unsigned long long
 #define ev_int64_t long long


Index: buffer.c
===================================================================
--- buffer.c    (revision 709)
+++ buffer.c    (working copy)
@@ -155,7 +155,7 @@
                va_copy(aq, ap);
 
 #ifdef WIN32
-               sz = vsnprintf(buffer, space - 1, fmt, aq);
+               sz = _vsnprintf(buffer, space - 1, fmt, aq);
                buffer[space - 1] = '\0';
 #else
                sz = vsnprintf(buffer, space, fmt, aq);


Index: WIN32-Code/event-config.h
===================================================================
--- WIN32-Code/event-config.h   (revision 709)
+++ WIN32-Code/event-config.h   (working copy)
@@ -50,8 +50,10 @@
 /* Define to 1 if you have the `inet_ntop' function. */
 /* #undef _EVENT_HAVE_INET_NTOP */
 
-/* Define to 1 if you have the <inttypes.h> header file. */
-#define _EVENT_HAVE_INTTYPES_H 1
+/* Define to 1 if you have the <inttypes.h> header file. */
+#if defined(_MSG_VER) && _MSC_VER >= 1300
+#define _EVENT_HAVE_INTTYPES_H 1
+#endif
 
 /* Define to 1 if you have the `kqueue' function. */
 /* #undef _EVENT_HAVE_KQUEUE */

